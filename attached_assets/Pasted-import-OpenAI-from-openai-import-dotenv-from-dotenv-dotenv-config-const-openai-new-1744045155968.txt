import OpenAI from "openai";
import dotenv from "dotenv";

dotenv.config();

const openai = new OpenAI({
  apiKey: process.env.OPENAI_API_KEY,
});

// Aqui entram os conteÃºdos da Aula 1 e Aula 2 (resumidos abaixo por brevidade)
const aula1 = `
Aula 1 - Como funciona a Ortopedia Funcional dos Maxilares

A Ortopedia Funcional dos Maxilares (OFM) usa aparelhos ortopÃ©dicos funcionais para corrigir disfunÃ§Ãµes maxilomandibulares. Atua no desenvolvimento Ã³sseo, funÃ§Ã£o muscular e oclusÃ£o, diferente da ortodontia, que alinha os dentes.

Objetivos incluem: melhorar mastigaÃ§Ã£o, tratar maloclusÃµes com estÃ­mulos funcionais, obter resultados precoces e estÃ¡veis, com menos extraÃ§Ãµes.

PrincÃ­pios fundamentais: excitaÃ§Ã£o neural, mudanÃ§a de postura mandibular, e suporte bimaxilar.

IndicaÃ§Ãµes: distoclusÃ£o, mordida cruzada, mordida aberta funcional, DTM, etc. ContraindicaÃ§Ãµes: pacientes com distÃºrbios neuromusculares graves, desvios esquelÃ©ticos acentuados, falta de colaboraÃ§Ã£o.

Aparelhos simples permitem movimento livre da mandÃ­bula; compostos guiam a posiÃ§Ã£o mandibular.

A OFM Ã© complementar Ã  ortodontia, e o planejamento adequado Ã© essencial para o sucesso.
`;

const aula2 = `
Aula 2 - MudanÃ§a de Postura TerapÃªutica na Ortopedia Funcional dos Maxilares

A mudanÃ§a de postura terapÃªutica ajusta a posiÃ§Ã£o mandibular para corrigir Classe II (distoclusÃ£o) ou Classe III (mesiooclusÃ£o).

Etapas: diagnÃ³stico, montagem do modelo com avanÃ§o mandibular (DA), confecÃ§Ã£o do aparelho, instalaÃ§Ã£o e acompanhamento.

Limite de avanÃ§o: mÃ¡x. 7 mm por vez. Em overjets maiores, usa-se dois aparelhos ou ajustes progressivos.

Formas de mudanÃ§a de postura: avanÃ§o mandibular, lateralizaÃ§Ã£o da mandÃ­bula, bloqueio frontal.

BenefÃ­cios: correÃ§Ã£o funcional e estrutural, crescimento equilibrado, melhora mastigatÃ³ria e respiratÃ³ria.
`;

const systemPrompt = `
VocÃª Ã© o Professor OFM. Responda apenas com base no conteÃºdo das aulas abaixo.
Se a informaÃ§Ã£o nÃ£o estiver disponÃ­vel nelas, diga: "Essa informaÃ§Ã£o nÃ£o estÃ¡ disponÃ­vel na apostila."

Apostila do Curso OFM:
${aula1}

${aula2}
`;

const askQuestion = async (userQuestion) => {
  const response = await openai.chat.completions.create({
    model: "gpt-4",
    messages: [
      { role: "system", content: systemPrompt },
      { role: "user", content: userQuestion },
    ],
    temperature: 0.3,
  });

  console.log("ðŸ§  Resposta do Professor OFM:\n");
  console.log(response.choices[0].message.content);
};

// Exemplo de pergunta
askQuestion("Qual Ã© a idade ideal para iniciar o tratamento com Ortopedia Funcional?");
